\section{Corruption of $\Disj$}

Материал этой секции изложен в соответствии со статьёй Разборова \cite{Razborov92-disj}.

Мы докажем нижнюю оценку на $corr(\Disj)$. Немного с другими константами, нежели в определении из
предыдущей секции, но, как мы уже выяснили, это совершенно не важно.

Пусть $A = \Disj^{-1}(1)$, $B = \Disj^{-1}(0)$.

Построим меру $\mu$ со следующими свойствами:

\begin{itemize}
    \item $\mu(A) = \frac{3}{4}$,
    \item для любого $R$ --- $1$-biased прямоугольника $\mu(R \cap B) \ge \alpha \mu(R \cap A) -
        2^{-\varepsilon n}$.
\end{itemize}

Если нам удастся построить такую меру, то нижняя оценка на вероятностную коммуникационную сложность сразу
последует. Что на самом деле означает второе свойство меры? Если мера $R$ не экспоненциально мала,
слагаемое $2^{-\varepsilon n}$ не вносит значительного вклада, и нули составляют константную долю
<<веса>> $R$. Если в определении $1$-biased прямоугольника у нас была константа меньше, чем $\alpha$, то
мы получаем немедленное противоречие. Значит, мера каждого такого $R$ должна быть экспоненциально
маленькой. Это и является оценкой на $corr(\Disj)$. 

Итак, построим меру $\mu$. Пусть $n = 4m - 1$.

\begin{enumerate}
    \item Выберем случайное разбиение $[n] = z_x \cup z_y \cup \{i\}$, $|z_x| = |z_y|$,
    \item $x \subseteq z_x \cup \{i\}$, $y \subseteq z_y \cup \{i\}$, каждый элемент выбирается в
        подмножество uniformly independently.
\end{enumerate}

Случайную величину $(z_x, z_y, i)$ обозначим $t$.

Рассмотрим также распределения $(x_0, y_0) = (x, y) \mid_{i \notin x, i \notin y}$ и $(x_1, y_1) = (x, y)
\mid_{i \in x, i \in y}$.

Входы Алисы и Боба будут распределены следующим образом: с вероятностью $\frac{3}{4}$ мы выбираем их из
распределения $(x_0, y_0)$, с вероятностью $\frac{1}{4}$ --- из $(x_1, y_1)$. Это сразу обеспечивает
первое свойство меры. Докажем второе. Зафиксируем конкретный $1$-biased прямоугольник $R = S \times T$.

Рассмотрим вероятности $p_x(t) = \Pr[x \in S \mid (z_x, z_y, i) = t]$, $p_y(t) = \Pr[y \in T \mid (z_x,
z_y, i) = t]$, а также $p_{x, 1}(t) = \Pr[x_1 \in S \mid (z_x, z_y, i) = t]$ и $p_{x, 0}(t)$,
$p_{y, 1}(t)$, $p_{y, 0}(t)$, определённые аналогично. 

\begin{remark}
    $p_x(t) = \frac{1}{2}(p_{x, 0}(t) + p_{x, 1}(t))$, аналогично
    $p_y(t) = \frac{1}{2}(p_{y, 0}(t) + p_{y, 1}(t))$.
\end{remark}

\begin{proof}
    Это формула полной вероятности, учитывая, что $i \in S$ с вероятностью $\frac{1}{2}$, а условие на
    $y$ никак не влияет, т.к. если зафиксировали $t$, то всё независимо.
\end{proof}

\begin{remark}
    $p_x(z_x, z_y, i)$ и $p_{y, 0}(z_x, z_y, i)$ зависят только от $z_y$.
\end{remark}

\begin{proof}
    В первом случае мы выбираем случайное подмножество $[n] \setminus z_y$, во втором~--- случайное
    подмножество $z_y$.
\end{proof}

Хотим показать, что $\Pr[(x_1, y_1) \in R] \ge \Omega(\Pr[(x_0, y_0) \in R]) - 2^{-\varepsilon n}$.

$\Pr[(x_1, y_1) \in R] = \Exp\limits_t[p_{x, 1}(t) \cdot p_{y, 1}(t)] \ge \Exp\limits_t[p_{x, 1}(t) \cdot
p_{y, 1}(t) \cdot (1 - \chi(t))]$, где $\chi(t)$~--- это характеристическая функция, показывающая, что
$t$ --- <<плохое>>. Мы назовём $t$ плохим, если $p_{x, 1}(t) \le \frac{1}{3}p_{x, 0}(t) -
2^{-\varepsilon n}$ ($x$-плохое) или $p_{y, 1} \leq \frac{1}{3} p_{y, 0}(t) - 2^{-\varepsilon n}$.

Тогда $\Exp\limits_t[p_{x, 1}(t) \cdot p_{y, 1}(t) \cdot (1 - \chi(t))] \ge
\Exp\limits_t[\frac{1}{3}p_{x, 0}(t)\frac{1}{3}p_{y, 0}(t)(1 - \chi(t))] - 2^{-\varepsilon n} \ge
\Omega(\Exp[p_{x, 0}(t)p_{y, 0}(t)(1 - \chi(t))]) - 2^{-\varepsilon n}$. Если у нас получится убрать
отсюда $\chi(t)$, то мы докажем теорему.

\begin{lemma}
    $\Pr[t \text{ is } x\text{-bad } \mid z_y = z] \le \frac{1}{5}$, аналогично для $y$-bad.
\end{lemma}

\begin{proof}
    Заметим, что, раз мы зафиксировали $z_y$, то $p_x = \mathrm{const}$. Разберём случаи.

    \begin{enumerate}
        \item $p_x \leq 2^{-\varepsilon n}$. Тогда условие $p_{x, 1}(t) \leq \frac{1}{3}p_{x, 0}(t) -
            2^{-\varepsilon n}$ не можем выполниться~--- все вероятности слишком маленькие, и $t$ не
            может быть $x$-плохим.
        \item $p_x > 2^{-\varepsilon n}$. Предположим, что условие леммы не выполняется, т.е.
            $$
                \Pr[(z_x, z_y, i) \text{ is } x\text{-bad } \mid z_y = z] > \frac{1}{5}.
            $$

            Пусть множество $M$~--- это случайный элемент $S \cap (co-Z)^{2m}$. Заметим, что $p_{x, 1}(t)
            = 2 p_x \Pr[i \in M]$. Аналогично $p_{x, 0}(t) = 2 p_x Pr[i \notin M]$. Тогда из того, что
            $t$~--- плохое, следует $\Pr[i \in M] \le \frac{1}{3} \Pr[i \notin M] \Rightarrow \Pr[i \in
            M] \le \frac{1}{4}$, и это верно для $> \frac{1}{5}$ элементов $i \in co-Z$.

            Рассмотрим случайные величины $\chi(i_1 \in M), \chi(i_2 \in M), \ldots, \chi(i_{2m} \in M)$,
            где $\{i_1, \ldots, i_{2m}\} = co-Z$.

            Посчитаем энтропию $M$. $m(2 - 4\varepsilon - o(1)) \le \entropy(M) \le \sum \entropy(\chi(i
            \in M)) \le 2m \frac{4}{5} + 2m \frac{1}{5} \entropy(\frac{1}{4}) \le 1.93m$,
            противоречие. Первое неравенство здесь использует то, что $p_x > 2^{-\varepsilon n}$; это
            стандартное неравенство для энтропии, подробнее мы не объясняли.
    \end{enumerate}
\end{proof}

Теперь, когда у нас доказана лемма, можем завершить доказательство теоремы. Нам достаточно показать, что
$\Exp[p_{x, 0}(t) p_{y, 0}(t) \chi(t)] \le \frac{4}{5}\Exp[p_{x, 0}(t)p_{y, 0}(t)]$. 

Зафиксируем $z_y = z$ и докажем неравенство для каждого конкретного $z$. Также будем рассматривать
отдельно $\chi_x(t)$ и $\chi_y(t)$, проведём доказательство для $\chi_x(t)$ с константой $\frac{2}{5}$,
для $\chi_y(t)$ всё будет аналогично.

После того, как мы зафиксировали $z$, $p_{y, 0}$ превратилось в константу, и можно вынести его из-под
матожидания.

$\Exp[p_{x, 0}(t)p_{y, 0}(t)\chi_x(t) \mid z_y = z] = p_{y, 0} \cdot \Exp[p_{x, 0}(t) \chi_x(t) \mid z_y
= z] \le p_{y, 0} \cdot \Exp[2p_{x} \chi_x(t) \mid z_y = z] = 2p_{y, 0}p_x \cdot \Exp[\chi_x(t) \mid z_y
= z]$.

Воспользовавшись леммой, получим, что это не больше, чем $\frac{2}{5} p_{y, 0}p_x$. При этом $p_{y, 0}p_x
= \Exp[p_{x, 0}(t)p_{y, 0}(t) \mid z_y = z]$. Почему? $p_{y, 0}$ --- константа, которую можно спокойно
внести обратно под матожидание. Про $p_x$ заметим, что $p_x = \Exp[p_{x, 0}(z_x, z_y, i) \mid z_y = z] =
\Pr[x_0 \in S \mid z_y = z]$, так как при условии $(z_y = z)$ $x_0$ принимает все значения из $(co-Z)^m$
с одинаковой вероятностью $\binom{2m}{m}^{-1}$.