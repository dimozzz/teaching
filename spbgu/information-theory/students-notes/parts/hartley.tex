\section{Информация по Хартли}

\subsection{Базовые свойства}

Пусть дано некоторое множество объектов. Мы хотим ввести некоторую \textit{меру информации}, то есть
хотим понять, сколько информации мы узнаём, получая некоторый элемент данного множества. Одна из
общепринятых мер информации~--- количество бит. Попробуем формализовать эту меру информации

\begin{definition}[Информация по Хартли]
    \label{def:hartley-inf}
	Пусть $A$~--- некоторое конечное множество. За \deftext{информацию в множестве} $A$~--- будем
    принимать следующую величину:
	$$
        \chi(A) \coloneqq \log{\abs{A}}.
    $$
\end{definition}

Данное определение хорошо ложиться на интуитивное представление о том, что необходимо $\log{\abs{A}}$ бит
для описания некоторого элемента множества. Отметим, что число $\chi(A)$ может быть нецелым.
\begin{remark}
	В отличие от курса анализа, под $\log$ мы везде понимаем логарифм по основанию $2$.
\end{remark}

Попробуем описать свойства этого определения.

\begin{proposition}
    Пусть $A \subseteq X \times Y$~--- конечное двумерное множество, $A_X$ --- его проекция на $X$,
    $A_Y$~--- на $Y$. Тогда выполнены следующие свойства: 
	\begin{enumerate}
        \item $\chi(A) \ge 0$;
        \item $\chi(A_X) \le \chi(A)$, $\chi(A_Y) \le \chi(A)$;
        \item $\chi(A) \le \chi(A_X) + \chi(A_Y)$.
    \end{enumerate}
\end{proposition}

\begin{proof}
	Следует из определения.
\end{proof}

Пользуясь этим определением мы можем доказать нетривиальные свойства множеств, например соотношение между
<<объёмом>> и площадями проекций.

\libproblem{inf-theory}{volume-3-dim}

Можем ли мы понять как изменится информация во множестве $A$, если мы уже про него что-то знаем?
Аналогично определению \ref{def:hartley-inf} мы можем описать <<условную информацию>>, содержащуюся в
множестве $A$.

\begin{definition}
	Пусть $A$~--- двумерное множество с проекциями $X$ и $Y$. \deftext{Условную информация} содержащуюся
    в множестве $A$, если мы уже знаем вторую координату, определим следующим образом: 
	$$
        \chi_{Y|X}(A) \coloneqq \max_x{\big(\log|A_x|\big)},
    $$ 
	где $A_x$ --- сечение $A$ по координате $x$.
\end{definition}

Если говорить интуитивно, то эта мера нам описывает достаточное количество бит, нужное для кодирования
элемента, зная его первую проекцию. Существенный недостаток это определения в том, что разным элементам
могут соответствовать сечения разных размеров, а мы этого никак не учитываем.

Нетрудно проверить, что при таком определении выполнено неравенство
$$
    \chi(A) \le \chi(A_Y) + \chi_{X|Y}(A).
$$


В дальнейшем иногда мы будем обозначать множество  $\{1, 2, \dots, n\}$ через $[n]$.

\subsection{Угадывание монетки}

\paragraph{Симметричный вариант.}
Рассмотрим некоторые применения информации по Хартли. Пусть есть два игрока, первый загадывает число от
$1$ до $n$. Сколько вопросов с ответом <<да/нет>> необходимо задать второму игроку, чтобы угадать число?
При этом у задачи есть два варианта: с \textit{неадаптивной} стратегией, когда второй игрок пишет все
вопросы заданы заранее, и \textit{адаптивной} стратегией, когда второй игрок задаёт очередной вопрос,
зная ответы на все предыдущие.  

Для верхней оценки, как в адаптивной, так и не в адаптивной стратегии мы можем предъявить простую
стратегию. Второй игрок может спросить каждый бит числа $n$ в двоичной записи; поэтому количество
запросов не превосходит $h = \lceil \log n \rceil$. Теперь давайте попробуем доказать, что ничего лучше
сделать мы все равно не сможем.
	
Пусть $Q_i$~--- ответ на $i$-ый вопрос (один бит), $N$~--- искомое число,
$$
    B \coloneqq Q_1\times Q_2 \times \cdots \times Q_h.
$$ 

Посмотрим на множество пар $(N, B)$ по всем возможным $N$ и $B$. Корректность протокола означает, что
если мы знаем все $Q_i$, то можем определить число, то есть $\chi_{B}([n]) = 0$. Легко заметить, что
$\chi(Q_i) \leq 1$. Тогда:
$$
    \log{n} \leq \chi(N, B) \leq \sum_{i=1}^{h} \chi(Q_i) + \chi_B([n]) = \sum_{i=1}^{h} \chi(Q_i) \le
    h.
$$
Таким образом, $h \ge \log{n}$, доказана нижняя оценка.
	
Ту же оценку можно было легко получить и другими, более простыми способами, но метод выше обобщается на
гораздо более сложные ситуации.

\paragraph{Асимметричный вариант.}
Немного усложним задачу. Пусть за каждый ответ <<да>> второй игрок платит $1$ монету, а за каждый ответ
<<нет>>~--- 2 монеты.

Давайте попробуем адаптировать нашу стратегию для этого случая. Попробуем запросом делить множество
<<пополам>> с точки зрения стоимости, то есть таким образом, чтобы при ответе <<нет>> мы бы узнавали в
два раза больше информации. (что, например, на первом шаге нам даст следующее соотношение:
$2 \chi_{Q_i = 1}([n]) = \chi_{Q_i = 0}([n])$).

Попробуем понять сколько нам потребуется заплатить при такой стратегии. Пусть $Q_i$~--- ответ на вопрос
<<верно ли, что загаданное число $N$ лежит в множестве $T_i \subseteq X_i$?>>. Пусть $X_i$~--- множество
элементов, в котором может лежать $N$ после первых $i$ вопросов. Наша стратегия говорит, что:
$$
    2 (\chi(X_i) - \chi(T_i)) = \chi(X_i) - \chi(X_i \setminus T_i)
$$

Распишем это по определению:
\begin{align*}
  2(\log|X_i| - \log |T_i|) = \log|X_i| - \log|X_i \setminus T_i| &\iff\\
  \log |X_i| = 2 \log |T_i| - \log |X_i \setminus T_i| &\iff\\
  |X_i| = \frac{|T_i|^2}{|X_i\setminus T_i|}.
\end{align*}

Обозначая $\abs{X_i} = k$, $\abs{T_i} = t$, получаем:
\begin{align*}
	k = t^2 / (k - t) &\iff t^2 = k(k - t) = k^2 - kt \iff\\
	t^2 + kt - k^2 = 0 &\iff t = \frac{-k \pm \sqrt{k^2 + 4k^2}}{2} = k\left(\frac{-1 \pm \sqrt{5}}{2} \right).
\end{align*}
Таким образом, для реализации нашей стратегии на каждом шаге нужно выбирать такое $T_i$, что $\varphi
|T_i| = |X_i|$, где $\varphi$~--- золотое сечение. Соответственно <<средняя цена>> бита информации будет
$2(\chi(X_i) - \chi(T_i)) = 2 \log \frac{1}{\varphi}$.

Поймем, что данная стратегия оптимальна. Не умаляя общности:
$$
    2 (\chi(X_i) - \chi(T_i)) > \chi(X_i) - \chi(X_i \setminus T_i),
$$
но в таком случае первый игрок может загадать такое число $x$, что $x \in T_i$, и второй игрок на этом
шаге заплатим большую, чем <<средняя>>, цену за бит информации.

\begin{remark}
    Конечно мы не можем поделить множество в иррациональной пропорции, но для больших $n$ мы можем сколь
    угодно близко приблизится к этому.
\end{remark}


Подобные игры с монетками используются в реальной жизни. В частности, размеры деревьев решений позволяют
доказывать нижние оценки на различные алгоритмы для задачи выполнимости булевых формул. А для оценок на
размеры деревьев решений используются игры с монетками. Рассмотрим пример.

\begin{example}
	Подобная стратегия применяется и в некоторых более современных задачах. Пусть есть $n + 1$ голубь и
    $n$ клеток. По принципу Дирихле нельзя посадить голубей в клетки таким образом, чтобы каждый сидел в
    клетке, и в одной клетке было бы не более одного голубя. Введем для каждой пары (голубь, клетка)
    переменную $x_{ij}$, будем считать, что  $x_{ij} = 1$ означает, что $i$-ый голубь сидит в $j$-ой
    клетке, и $x_{ij} = 0$, если это не так. Тогда эти условия принципа Дирихле можно записать в виде
    невыполнимой системы уравнений:
    \begin{enumerate}
        \item для всех $i \in [n + 1]$: $\prod\limits_{j = 1}^{n}(1 - x_{ij}) = 0$;
        \item для всех $i, i', j$, где $i \neq i'$: $x_{ij} \cdot x_{i'j} = 0$.
    \end{enumerate}

    Один игрок загадывает рассадку голубей, а второй пытается найти, какое из условий нарушено. В статье
    \cite{BeyGalLau10} приведено <<простое>> доказательство нижней оценки на размер дерева решений для
    данной задачи, доказательство использует игру с монетками.
\end{example}


\subsection{Взвешивание монеток}
\label{sec:fake-coin}

Рассмотрим еще один пример применения. Пусть даны $n$ монеток, из которых одна фальшивая и имеет другой
вес, и рычажные весы. Вопрос~--- можно ли за $m$ взвешиваний определить фальшивую монету? Решите задачу
в следующих вариантах:
\begin{enumerate}
    \item $n = 30$, $m = 3$;
  	\item $n = 15$, $m = 3$;
    \item $n = 14$, $m = 3$.
\end{enumerate}

В отличие от предыдущей задачи, каждое взвешивание приносит больше информации:
$\chi(Q_i) \leq \log_2 3$, так как возможны $3$ ответа на каждый вопрос. Рассмотрим все варианты данной задачи.
\begin{enumerate}
    \item При правильном протоколе должно быть выполнено неравенство
        $$
            \log_2(30) = \chi([30]) \le \sum_{i = 1}^3 \chi(Q_i) + \chi_B([30])
            = \chi(Q_1) + \chi(Q_2) + \chi(Q_3) \le \log_2(27),
        $$
		что неверно. Значит, ответ~--- <<нет>>.
    \item В случае $n = 15 $ оценка выше не даёт требуемого результата. Если добавить также условие, что
        надо определить, какая монета тяжелее, то надо рассматривать множество $[15] \times \{0, 1\}$, где
        $0$ означает, что монета фальшива; и тогда верхняя оценка сработает. 
		
		Пусть надо только определить фальшивую монету. Заметим, что если хотя бы при одном взвешивании не
        было достигнуто равновесие, то мы можем определить не только фальшивую монету, но и то, тяжелее
        она или легче обычных. Пусть монетка, получающаяся как ответ при трёх равновесиях, имеет номер
        $k$. Тогда реально мы определяем информацию множества
		$$([15] \setminus \{k\}) \times \{0,1\} \cup \{k\}$$
        порядка $29$. Поскольку $29 > 27$, ответ по-прежнему нет.
    \item Поскольку $2 \cdot 13 + 1 = 27$, то предыдущее рассуждение не работает. Однако ответ всё ещё
        <<нет>>, но для доказательства нам понадобится некоторая теория.
\end{enumerate}